
- hosts:
    - db
  vars_files:
    - vars.yml
  tasks:
    - name: install db server
      debug:
        msg: "install db server"

    - name: copy mysql/mongodb conf to yum repo
      get_url:
        url: "{{ item }}"
        dest: /etc/yum.repo.d/
      loop: "{{ yum_repo }}"

#    - name: copy mongodb conf to yum repo
#      copy:
#        path: "{{ mongodb_repo }}"
#        dest: /etc/yum.repo.d/

    - name: install geerlingguy.mysql - mariadb
      include_role:
        name: geerlingguy.mysql
      vars_files:
          - vars.yml
      when: enable_mysql

    - name: install greendayonfire.mongodb
      include_role:
        name: greendayonfire.mongodb
      vars_files:
          - vars.yml
      when: enable_mongodb

    - name: install DavidWittman.redis
      include_role:
        name: DavidWittman.redis
      vars_files:
          - vars.yml
      when: enable_redis

    - name: install wtanaka.apache-kafka
      include_role:
        name: wtanaka.apache-kafka
      vars_files:
          - vars.yml
      when: enable_kafka
